# リファインメントブリーフ: gas-ai-coding

## 基本情報
- 対象ファイル: src/content/articles/gas/gas-ai-coding.md
- 監査日: 2026-02-12
- 総合スコア: 68/100
- 判定: REFINE

## スコアサマリ
| カテゴリ | スコア | 主な減点理由 |
|---------|--------|-------------|
| コンテンツ品質 | 12/20 | 実行可能なコード例が0（プロンプトのみ）、定義文が1/5のH2にしかない、「まとめ」セクション欠如、応用セクションが箇条書き3項目で薄い |
| SEO/AEO品質 | 14/20 | 副KW「AI GAS コード生成」が本文に未出現、H2が6つありCLAUDE.md上限5に違反、孤立H3（親H2なし）が1件 |
| 内部リンク・導線 | 15/20 | 本文中に6本の内部リンクがあり良好だが、他記事からの被リンクが0本（孤立記事）、relatedArticlesのgas-basicsがピラーで適切だが別カテゴリ枠のclaude-code-automationが実質gasと同系統の技術記事 |
| 可読性・文体 | 15/20 | プロンプトブロックの形式は統一感があるが、各プロンプト後の解説が1文のみで薄い。AIが生成するコードの期待出力例がない。専門用語（getValues/setValues, muteHttpExceptions, スクリプトプロパティ）の説明不足 |
| 鮮度・正確性 | 12/20 | Claude Code料金「月20ドル」に公式URLなし・時点表記がFAQのみで前提表になし、Claude Haiku 4.5のモデルIDが正確か検証困難、Claude Codeの具体的な操作手順（インストール・起動・プロンプト投入方法）が未記載 |

## セクション別判定
| セクション | 判定 | 理由 |
|-----------|------|------|
| 導入部（blockquote + 要約2文） | KEEP | Layer導線（gas-basicsとclaude-code-automationへ）が明確。結論ファーストで端的 |
| 孤立H3「この記事の前提」 | IMPROVE | CLAUDE.md「H2の下にH3で補足」に違反。H3が親H2なしで孤立。H2に昇格するか、導入セクションのH2配下に移動が必要 |
| H2-1「プロンプト設計の基本」 | KEEP | 定義文あり、4要素の表が分かりやすい。prompt-engineering-businessへの横断リンクも適切 |
| H2-2「スプレッドシート操作のプロンプト」 | IMPROVE | プロンプト例2件は実用的だが、AIが生成するコードの出力例（期待される結果）がない。各プロンプト後の解説が1文で薄い。beginner向けとして「このプロンプトを投入した結果どうなるか」の説明が必要 |
| H2-3「メール自動化のプロンプト」 | IMPROVE | プロンプト自体は良いが、定義文なし。メール一斉送信のリスク注意書きが不足。1件のプロンプトのみでセクションとして薄い |
| H2-4「AI API連携のプロンプト」 | IMPROVE | 定義文なし。Claude API呼び出しのプロンプトは具体的で良いが、期待されるレスポンス例がない |
| H2-5「生成コードのチェックリスト」 | KEEP | 表形式で5つのチェック項目。実務的で有用。定義文を追加すればなお良い |
| H2-6「応用・カスタマイズ例」 | REWRITE | 定義文なし。箇条書き3項目のみで具体性が乏しい。中小企業のユースケースへの落とし込みがない。「まとめ」セクションが記事全体に存在せず、ここが実質最終セクションだが締めくくりとして機能していない |

## 改善指示一覧（優先度順）

### 指示1: H2数を5つ以内に再構成（構造違反の修正）
- 対象: 記事全体の見出し構造
- 何を: 現在H2が6つあり、CLAUDE.md「H2は5つ以内」に違反。以下のように再構成する
- なぜ: CLAUDE.md構造ルールへの準拠
- 方向性:
  - H2-2「スプレッドシート操作のプロンプト」、H2-3「メール自動化のプロンプト」、H2-4「AI API連携のプロンプト」を「プロンプト実例集」（H2）にまとめ、各カテゴリをH3にする
  - 結果: (1)プロンプト設計の基本、(2)プロンプト実例集、(3)生成コードのチェックリスト、(4)応用・カスタマイズ例、(5)まとめ の5つ

### 指示2: 孤立H3「この記事の前提」をH2配下に移動
- 対象: 導入部の「### この記事の前提」
- 何を: 「## プロンプト設計の基本」の冒頭に前提表を移動するか、独立した「## 前提条件」をH2として設置
- なぜ: CLAUDE.md「H2の下にH3で補足」に違反。H3が親H2なしで孤立
- 方向性: 指示1の再構成と合わせ、「## プロンプト設計の基本」の冒頭にH3「この記事の前提」を配置するのが自然

### 指示3: 「まとめ」セクションを追加
- 対象: 記事末尾
- 何を: 「## まとめ」セクションを追加し、記事の要点を3-5行で総括。次のステップとして関連記事へのCTAを配置
- なぜ: CLAUDE.mdの記事テンプレートに「## まとめ」「## 次のステップ」が規定されている。現状は「応用・カスタマイズ例」で唐突に終了しており、読後のアクション喚起がない
- 方向性:
  ```markdown
  ## まとめ

  本記事では、Claude Codeを使ってGASスクリプトを生成するための
  プロンプト実例を3カテゴリ（スプレッドシート操作・メール自動化・AI API連携）で紹介しました。

  ポイントは以下の3つです。
  - プロンプトに「役割・タスク・入出力・制約」の4要素を含める
  - 生成コードは必ずチェックリストで検証する
  - まずは1つのプロンプトから試し、段階的に複合処理へ拡張する

  → GASの基本を押さえたい方は[GASでできること完全ガイド](/articles/gas/gas-basics)へ
  → プロンプト設計を体系的に学びたい方は[業務プロンプト設計入門](/articles/frameworks/prompt-engineering-business)へ
  ```

### 指示4: 料金情報に時点表記と公式URLを追加
- 対象: frontmatter（estimatedCost）+ 前提表 + FAQ
- 何を: 前提表の費用行に「（2026年2月時点）」と公式URLを追記。estimatedCostにも時点を付与
- なぜ: CLAUDE.mdの「料金情報は公式URLを必ずリンクし『2026年2月時点』等の時点を明記」に違反。現状FAQにのみ「2026年2月時点」とあるが、前提表にはない
- 方向性: 前提表の費用行を「Claude Pro [月20ドル](https://www.anthropic.com/pricing)（2026年2月時点）」に変更。estimatedCostを「0円〜月20ドル（2026年2月時点）」に変更

### 指示5: 各H2冒頭に定義文を追加
- 対象: 定義文が欠如しているH2（再構成後のプロンプト実例集、生成コードのチェックリスト、応用・カスタマイズ例、まとめ）
- 何を: 各H2の冒頭に「〇〇とは、△△です。」形式の定義文を1文追加
- なぜ: CLAUDE.mdの「『〇〇とは、△△です。』の定義文をセクション冒頭に含める」に準拠するため。現状はH2-1のみ
- 方向性:
  - プロンプト実例集: 「ここでは、業務で頻出する3カテゴリ（スプレッドシート操作・メール送信・AI API連携）のプロンプトテンプレートを掲載します。」
  - 生成コードのチェックリスト: 「チェックリストとは、AIが生成したコードを本番環境に適用する前に確認すべき安全性の項目一覧です。」
  - 応用・カスタマイズ例: 「基本のプロンプトパターンを組み合わせることで、より複雑な業務フローの自動化にも対応できます。」

### 指示6: プロンプト例にAI生成コードの期待出力サンプルを追加
- 対象: H2-2（スプレッドシート操作）の「月別売上集計」プロンプト
- 何を: 少なくとも1件のプロンプトについて、AIが生成するコードの出力例（期待されるGASスクリプトの抜粋）を掲載
- なぜ: HowTo記事として「プロンプトを投入したらどうなるか」が分からない。CLAUDE.md「コード例は実行可能な状態にする（省略しない）」に準拠するため。現状コード例が0件
- 方向性: 月別売上集計プロンプトの直後に「このプロンプトで生成されるコード例」として、5-15行程度のGASスクリプトサンプルを掲載。全プロンプトに付ける必要はないが、最低1件は「入力→出力」の完全な流れを示す

### 指示7: 専門用語の説明を追加
- 対象: 全体
- 何を: 以下の用語に初出時の説明を追加
  - getValues() / setValues(): 「スプレッドシートのデータを一括で読み書きするGASメソッド」
  - muteHttpExceptions: 「APIリクエストがエラーでもスクリプトを停止させずレスポンスを取得するオプション」
  - スクリプトプロパティ: 「GASのプロジェクトに紐づくキーバリュー型の安全な設定保存領域」
  - Utilities.sleep(): 「指定ミリ秒だけ処理を一時停止する関数」
- なぜ: difficulty=beginnerの記事であり、CLAUDE.md「専門用語は初出時に必ず説明を付ける」に準拠
- 方向性: プロンプトテンプレート内では括弧注記が不自然なため、プロンプト前後の解説文中に用語説明を組み込む

### 指示8: 副KW「AI GAS コード生成」を本文に自然配置
- 対象: 導入部または「プロンプト設計の基本」
- 何を: keyword-mapの副KW「AI GAS コード生成」「Claude Code プロンプト実例」のうち「AI GAS コード生成」が本文中に未出現。自然に1-2回配置する
- なぜ: 副KWの本文内自然配置はSEO基本要件
- 方向性: 導入要約文を「Claude Codeを使ったAIによるGASコード生成のプロンプト実例集を紹介します」等に調整

### 指示9: Claude Codeの操作手順の補足
- 対象: 導入部または「プロンプト設計の基本」
- 何を: Claude Codeでのプロンプト投入方法（CLIでの基本操作、GASプロジェクトとの接続方法）を2-3行で簡潔に補足するか、claude-code-automationへの誘導を明確化
- なぜ: 記事タイトルが「Claude Codeで書く」であるのに、Claude Codeの操作方法が全く記載されていない。beginner向け記事としてギャップが大きい
- 方向性: 冒頭のblockquoteで十分に誘導しているため、「プロンプト設計の基本」の冒頭に「以下のプロンプトはClaude Codeのターミナルに直接入力するか、チャットウィンドウに貼り付けて使用します」程度の1文を追加

### 指示10: 被リンク獲得のためのrelatedArticles逆登録
- 対象: gas-basics.md, gas-spreadsheet-automation.md, claude-code-automation.md のrelatedArticles
- 何を: gas-ai-codingへのリンクが他記事から0本（完全孤立）。関連性の高い記事のrelatedArticlesにgas-ai-codingを追加
- なぜ: 被リンク0はクラスター内での導線断絶を意味する。内部リンク戦略として双方向リンクが基本
- 方向性: gas-basics.mdまたはgas-claude-api.mdのrelatedArticlesに "gas/gas-ai-coding" を追加検討（relatedArticles上限5件に注意）

## 保持すべき良い点
- 冒頭blockquoteによるLayer導線（gas-basicsへ + claude-code-automationへ）は明確で良い構成。変更しないこと
- プロンプトテンプレートの4要素分解（役割・タスク・入出力・制約）は独自性があり、他のAIコーディング系記事との差別化要素
- プロンプト内の制約条件がセキュリティ（スクリプトプロパティからのAPIキー取得）やパフォーマンス（getValues一括取得）を含んでおり実務的
- 「生成コードのチェックリスト」セクションの表は実用的で、読者がすぐ使える形式
- gas-claude-api、gas-spreadsheet-automation、gas-mail-automationへの本文内リンクが自然な文脈で埋め込まれている
- FAQ 4件の選定は検索意図に合致しており適切。特にQ3「AIが生成したコードはそのまま使って大丈夫ですか？」は記事の本質に関わる重要なFAQ
- frontmatterのschema設定（HowTo + estimatedCost + totalTime）が適切
- descriptionが134文字でSEO推奨範囲（120-160文字）に収まっている

## frontmatter修正指示
- title: 変更不要（primary KW「Claude Code GAS スクリプト」含有、31文字、60文字制限内）
- description: 変更不要（134文字、KW含有、行動喚起あり）
- schema.estimatedCost: 「0円〜月20ドル（2026年2月時点）」に変更
- faq: 変更不要（4問で適切、3-5個の範囲内）
- relatedArticles: 変更不要（gas/gas-basics + gas/gas-spreadsheet-automation = 同カテゴリ2本、ai-api/claude-code-automation = 別カテゴリ1本で適切）
- tags: 変更不要
