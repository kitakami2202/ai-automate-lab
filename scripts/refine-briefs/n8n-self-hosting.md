# リファインメントブリーフ: n8n-self-hosting

## 基本情報
- 対象ファイル: src/content/articles/no-code/n8n-self-hosting.md
- 監査日: 2026-02-12
- 総合スコア: 80/100
- 判定: REFINE

## スコアサマリ
| カテゴリ | スコア | 主な減点理由 |
|---------|--------|-------------|
| コンテンツ品質 | 17/20 | H2-3の定義文が形式的。Caddyfileの環境変数がdocker-compose.ymlで未定義のため実行不可。ワーカーモード/LDAP連携の具体性不足 |
| SEO/AEO品質 | 16/20 | descriptionが約100文字で120文字未満（推奨120-160文字の下限割れ）。titleに「中小企業向け」等のターゲット訴求なし。副KW「n8n 構築」の明示配置なし |
| 内部リンク・導線 | 14/20 | ピラー記事(no-code-overview)への本文中導線なし。n8n-ai-workflowへの導線が皆無。zapier-vs-makeが冒頭と末尾で重複。Layer 2テンプレート「冒頭にLayer 1ピラーへのリンク」の対象がピラー記事でなくcomparison記事 |
| 可読性・文体 | 18/20 | 「リバースプロキシ」が初出時に未定義。他は良好 |
| 鮮度・正確性 | 15/20 | Caddyコンテナへの環境変数未定義で動作保証に懸念。n8n:latestタグは本番ではバージョン固定推奨。descriptionのCLAUDE.md準拠不足 |

## 詳細採点

### コンテンツ品質（17/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| 結論ファースト | 4 | 4 | 冒頭3行で「Docker Composeで約30分で構築」「コピペだけで動く」と明確に要約。前提表も冒頭に配置しており模範的 |
| 定義文 | 4 | 3 | H2-1(L51)「セルフホスティングとは〜」、H2-2(L83)「環境構築とは〜」、H2-3(L123)「実装手順とは〜」、H2-4(L292)「動作確認とは〜」、H2-5(L343)「応用・カスタマイズとは〜」。全H2に配置済みだが、H2-3の定義文「設定ファイルの作成からコンテナ起動までの一連の作業ステップです」が形式的で定義として弱い |
| 表の活用 | 4 | 4 | 5つの表（前提表、コスト比較表、VPS比較表、環境変数表、トラブルシューティング表）を適切に配置。比較表は料金・スペックの具体的数値を含み実用的 |
| コード実行可能性 | 4 | 3 | docker-compose.yml、Caddyfile、.env、bashコマンドを全文掲載。ただしCaddyfileの`{$N8N_HOST}`環境変数がdocker-compose.ymlのcaddyサービスに渡されていないため、そのままでは動作しない可能性がある |
| 情報の具体性 | 4 | 3 | VPS比較表、コスト削減金額、環境変数表が具体的。ワーカーモードやLDAP/SAML連携は概要のみで公式リンクに委ねている |

### SEO/AEO品質（16/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| title適切性 | 4 | 3 | 「n8nセルフホスティング完全ガイド - Docker Composeで構築」30文字。primary_kw含有。ただし「完全ガイド」が汎用的で、ターゲット（中小企業）への訴求がない |
| description質 | 4 | 3 | 約100文字で推奨範囲120-160文字の下限を下回る。内容は良いがSEO的にスニペット表示領域を活用しきれていない |
| schema適切性 | 4 | 4 | HowToスキーマでhowto記事に合致。estimatedCostとtotalTimeも設定済み |
| FAQ質 | 4 | 4 | 5個で検索意図と合致。サーバースペック・旧認証廃止・コスト差・バックアップ・ローカル環境と多角的。数値を含む具体的回答 |
| 副KW配置 | 4 | 2 | 「n8n 自己ホスティング」はL51で1回配置。「n8n 構築」は明示的配置なし。副KWの分散が不十分 |

### 内部リンク・導線（14/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| Layer遷移導線 | 5 | 3 | L37で冒頭にzapier-vs-makeへのリンクあり。しかしCLAUDE.md「Layer 2冒頭にLayer 1ピラーへのリンク」の対象はピラー記事(no-code-overview)であるべき。zapier-vs-makeはcomparison記事でありピラー記事ではない |
| 内部リンク数 | 5 | 4 | 本文中にユニーク内部リンク5本。3本以上で基準クリア。ただしzapier-vs-makeが冒頭(L37)と末尾(L361)で2回出現し重複感あり |
| relatedArticles関連性 | 5 | 5 | 同カテゴリ2本(no-code/no-code-overview, no-code/zapier-vs-make) + 別カテゴリ1本(reviews/automation-tools-matrix)でCLAUDE.md完全準拠 |
| リンクテキスト自然さ | 5 | 2 | zapier-vs-makeが冒頭と末尾で重複。n8n-ai-workflow（n8n構築後の最も自然な次ステップ）への導線が皆無。ピラー記事(no-code-overview)への本文中リンクもない。末尾のzapier-vs-makeリンクをn8n-ai-workflowに置き換えるのが自然 |

### 可読性・文体（18/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| 敬体統一 | 5 | 5 | 全文「です・ます調」で完全統一 |
| 一文の長さ | 5 | 4 | 本文中に80文字超過の文は見当たらず概ね良好。FAQ回答の一部が長めだが許容範囲 |
| 段落構造 | 5 | 5 | ステップ形式で論理的に進行。各ステップが見出し→コード→ポイント解説の3構造で統一されている |
| 専門用語説明 | 5 | 4 | Docker Compose、Caddy、PostgreSQL、VPS、LDAP、SAMLにすべて括弧書きの説明あり。ただし「リバースプロキシ」(L56, L193)が初出時に未定義。ターゲット読者（中小企業の経営者・事務担当者）には馴染みのない用語 |

### 鮮度・正確性（15/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| バージョン最新性 | 5 | 4 | n8n v1.0以降の認証方式変更を反映。Docker Compose v2形式。postgres:16-alpine。updatedAt: 2026-02-09で直近更新済み。ただしn8n:latestタグは本番環境ではバージョン固定が推奨される |
| 料金時点明記 | 5 | 5 | コスト比較表(L68-75)に「2026年2月時点」明記。VPS比較表(L89-94)にも「2026年2月時点」明記。文末補足あり。公式URLもすべてリンク付き。FAQ回答にも時点表記あり |
| コード動作保証 | 5 | 3 | docker-compose.ymlのcaddyサービスにenvironment設定がなく、Caddyfileの`{$N8N_HOST}`環境変数がコンテナ内に渡されない。.envの変数はDocker Compose経由でサービスに自動展開されるが、Caddyfileはコンテナ内で読まれるファイルのため、Caddyコンテナ自体にenvironment設定が必要 |
| CLAUDE.md準拠 | 5 | 3 | descriptionが120文字未満で推奨下限割れ。ピラー記事への本文中導線なし。「リバースプロキシ」未定義。Layer 2テンプレートのピラー記事導線が不正確 |

## セクション別判定

| セクション | 判定 | 理由 |
|-----------|------|------|
| frontmatter | **IMPROVE** | descriptionを120-160文字に拡充。titleに中小企業訴求を検討。副KW「n8n 構築」をdescriptionに含めると良い |
| 導入部（冒頭3行+前提表） | **IMPROVE** | 結論ファーストは模範的。ただし冒頭のLayer 1導線がzapier-vs-make(comparison)でありピラー記事(no-code-overview)ではない。ピラー記事への導線を追加 |
| H2-1: この記事で作るもの | **KEEP** | セルフホスティングの定義文、構成図、コスト比較表、旧認証廃止の注意点。すべて適切 |
| H2-2: 準備・環境構築 | **KEEP** | VPS比較表・Docker確認コマンドが実用的。料金時点表記も完備 |
| H2-3: 実装手順 | **IMPROVE** | docker-compose.ymlのcaddyサービスにN8N_HOST環境変数を渡す設定を追加。定義文を改善。n8n:latestのバージョン固定についてのコメントを追加検討 |
| H2-4: 動作確認・トラブルシューティング | **KEEP** | チェックリスト、エラー対応表、アップデート手順、バックアップ手順が充実 |
| H2-5: 応用・カスタマイズ例 | **IMPROVE** | n8n-ai-workflowへの導線を追加。末尾のzapier-vs-make重複リンクをn8n-ai-workflowに置き換え。ピラー記事(no-code-overview)への導線も追加 |
| FAQ | **KEEP** | 5個で検索意図合致。具体的数値を含む回答。時点表記あり |

## 改善指示一覧（優先度順）

### 指示1: docker-compose.ymlのcaddyサービスにenvironment設定を追加する【重大】
- 対象: H2-3「実装手順」ステップ1のdocker-compose.yml
- 何を: caddyサービスにN8N_HOST環境変数を渡す設定を追加
- なぜ: Caddyfileの`{$N8N_HOST}`はCaddyコンテナ内の環境変数を参照するが、現在のdocker-compose.ymlではcaddyサービスにenvironment設定がない。.envの変数はDocker Composeのサービス定義内の`${}`で展開されるが、Caddyfileはコンテナ内でCaddyプロセスが読むファイルであり、コンテナの環境変数として明示的に渡す必要がある。このままではHTTPS設定が正しく動作しない
- 方向性: caddyサービスに以下を追加:
```yaml
  caddy:
    image: caddy:2-alpine
    restart: unless-stopped
    environment:
      - N8N_HOST=${N8N_HOST}
    ports:
      - "80:80"
      - "443:443"
```

### 指示2: ピラー記事(no-code-overview)への本文中導線を追加する
- 対象: 導入部（L37付近）
- 何を: ピラー記事no-code-overviewへの内部リンクを追加
- なぜ: CLAUDE.md「Layer 2記事は冒頭にLayer 1ピラーへのリンク」に準拠するため。現在はzapier-vs-make(comparison記事)への導線のみで、ピラー記事への導線がない。no-codeクラスターのピラー記事はno-code-overview
- 方向性: L37を以下に変更:
  「この記事は[ノーコード自動化ツール比較](/articles/no-code/no-code-overview)の実装編です。ツール選定の基準は[Zapier vs Make 徹底比較](/articles/no-code/zapier-vs-make)をご覧ください。」

### 指示3: n8n-ai-workflowへの導線を追加する
- 対象: H2-5「応用・カスタマイズ例」末尾（L361付近）
- 何を: n8n-ai-workflowへの内部リンクを追加し、末尾のzapier-vs-make重複リンクを置き換え
- なぜ: n8n構築完了後の最も自然な次ステップは「n8nでAI連携ワークフローを作る」こと。n8n-ai-workflowは当記事を前提記事として参照しているが、逆方向の導線がない。zapier-vs-makeは冒頭で既にリンク済みで末尾での重複は不要
- 方向性: L361の末尾を以下に変更:
  「n8nの構築が完了したら、[n8n × AI連携ワークフロー](/articles/no-code/n8n-ai-workflow)でAIを組み込んだ業務自動化にも挑戦してみてください。」

### 指示4: descriptionを120-160文字に拡充する
- 対象: frontmatter `description`
- 何を: 現在約100文字のdescriptionを120-160文字の推奨範囲に拡充
- なぜ: CLAUDE.md「description は120-160文字」の下限を下回っている。SEOスニペット表示領域を活用しきれていない
- 方向性: 副KW「n8n 構築」を含め、120-160文字に調整。例:
  「n8nをDocker Composeでセルフホスティングする構築手順を解説。PostgreSQL・Caddy（HTTPS）対応の本番構成をコピペで構築できます。Zapier・Makeとのコスト比較表、VPS選定ガイド、トラブルシューティングも掲載。中小企業のサーバー代を月額500円〜に抑えて自動化基盤を整えましょう。」（約140文字目安で調整）

### 指示5: 副KW「n8n 構築」を本文中に自然配置する
- 対象: H2-2またはH2-3
- 何を: 副KW「n8n 構築」を本文中に1-2箇所自然に配置
- なぜ: secondary_kwの「n8n 構築」が本文中に明示的に配置されていない
- 方向性: H2-2の定義文やH2-3の冒頭に「n8nの構築に必要な〜」「n8nを構築するには〜」等の形で自然に織り込む

### 指示6: 「リバースプロキシ」に初出定義を追加する
- 対象: L56「Caddy (HTTPS/リバースプロキシ)」（初出箇所）
- 何を: 「リバースプロキシ」に括弧書きの説明を追加
- なぜ: CLAUDE.md「専門用語は初出時に必ず説明を付ける」に違反。中小企業の経営者・事務担当者がターゲットであり、リバースプロキシは馴染みのない用語
- 方向性: 構成図の後のポイント解説(L60)に「Caddy（外部からのアクセスを内部サービスに中継するリバースプロキシ兼Webサーバー）」等の説明を追加

### 指示7: H2-3の定義文を改善する
- 対象: L123「実装手順とは、設定ファイルの作成からコンテナ起動までの一連の作業ステップです。」
- 何を: より具体的で有用な定義文に改善
- なぜ: 「一連の作業ステップ」がトートロジーで定義として機能していない
- 方向性: 「実装手順では、Docker Composeの設定ファイル作成・環境変数の設定・コンテナ起動・初期セットアップの4ステップでn8n環境を構築します。」等、ステップ数や内容を具体的に示す定義に改善

### 指示8: n8n:latestのバージョン固定に関する注記を追加する（任意）
- 対象: H2-3 ステップ1のdocker-compose.yml（L131）
- 何を: n8n:latestタグについて、本番環境ではバージョン固定を推奨する注記を追加
- なぜ: latestタグはpull時に予期しないメジャーバージョンアップが発生するリスクがある。本番環境のベストプラクティスとしてバージョン固定を推奨すべき
- 方向性: コードのポイントに「本番環境では`n8nio/n8n:1.76.1`のようにバージョンを固定すると、予期しない破壊的変更を防げます。最新バージョンは[Docker Hubのn8nページ](https://hub.docker.com/r/n8nio/n8n/tags)で確認してください」を追加

## 保持すべき良い点
- 冒頭の結論ファーストと前提表が模範的（読者が即座に前提条件を把握できる）
- H2-1のセルフホスティング定義→構成図→コスト比較表の流れが論理的
- docker-compose.yml、.env、Caddyfileの全文掲載（コピペで構築可能）
- 環境変数のハードコードを一切行わず、CLAUDE.md「APIキーハードコード禁止」完全準拠
- N8N_ENCRYPTION_KEY紛失リスクの警告（実務的に重要な一次情報）
- トラブルシューティング表の5つのエラーパターンが実用的
- バックアップ手順の掲載（構築記事で見落としがちな運用観点をカバー）
- FAQ5個の多角的なカバー範囲と具体的数値を含む回答
- 料金情報の時点表記と公式URLリンクの徹底
- 全文の敬体統一と適切な段落構造
- relatedArticlesの構成（同カテゴリ2本+別カテゴリ1本）が完全準拠
- 専門用語の初出説明が大部分で適切に行われている

## frontmatter修正指示
- title: 変更検討 → 「中小企業向け」等のターゲット訴求を追加するか検討。ただし現在30文字で60文字上限内であり、primary_kw含有で基本は適切
- description: **要修正** → 120-160文字に拡充。副KW「n8n 構築」を含める
- schema: 変更不要（HowToでhowto記事に適切）
- faq: 変更不要（5個、検索意図合致、具体的回答）
- relatedArticles: 変更不要（同カテゴリ2本+別カテゴリ1本で適切）
