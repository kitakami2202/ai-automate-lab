# スコアレポート: gas-chatgpt-api

## 基本情報
- 対象ファイル: src/content/articles/gas/gas-chatgpt-api.md
- 監査日: 2026-02-12
- 総合スコア: 74/100
- 判定: **REFINE**（部分改善）

## スコアサマリ

| カテゴリ | スコア | 主な減点理由 |
|---------|--------|-------------|
| コンテンツ品質 | 14/20 | H2「応用・カスタマイズ例」に定義文なし、「まとめ」セクションがなく次のアクションが不明確、ステップ3のFAQ連携コードがステップ2と大部分重複 |
| SEO/AEO品質 | 16/20 | secondary_kw「GAS 問い合わせ 自動回答」の本文での自然配置が不十分、descriptionが157文字でほぼ上限（余裕なし） |
| 内部リンク・導線 | 14/20 | APIキー管理記事（api-key-management）へのリンクなし、Googleフォーム連携（gas-form-automation）へのリンクなし（姉妹記事gas-claude-apiにはある） |
| 可読性・文体 | 16/20 | UrlFetchApp・temperature・max_tokensなど専門用語が初出時に未定義、FAQ回答内の「業務プロンプト設計入門」が正式記事タイトルと不一致 |
| 鮮度・正確性 | 14/20 | OpenAI新規登録の無料クレジット5ドルが現在も有効か要確認（変更頻度の高い情報）、Responses APIへの言及なし（openai-api-intro記事では言及済み） |

## 詳細採点

### コンテンツ品質（14/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| 結論ファースト | 4 | 4 | L36-37で「GASからChatGPT APIを呼び出して回答ドラフトを自動生成する仕組みを約40分で構築する手順を解説」と要約。冒頭blockquoteでLayer 1へのリンクも完備 |
| 定義文 | 4 | **2** | H2-1(L50)「GAS × ChatGPT API連携とは...」定義文あり。H2-2(L61)「準備とは...」定義文あり。H2-3(L78)「実装手順」は手順見出しとして定義文不要で許容。**H2-5(L262)「応用・カスタマイズ例」に定義文なし** |
| 表の活用 | 4 | 4 | 前提表(L41)、機能一覧表(L53)、スプレッドシート構成表(L183)、トラブルシューティング表(L244)、コスト目安表(L253)の5つの表で十分 |
| コード実行可能性 | 4 | 4 | 3つのコードブロックがすべて完全な関数定義。コピペで動作する状態。APIキーのハードコードなし |
| 情報の具体性・まとめ | 4 | **0** | **「まとめ」セクションが完全に欠落**。howto記事テンプレートの「まとめ」「次のステップ」が未実装。読者が記事を読み終えた後の行動指針がない。ステップ3のgenerateSmartReply関数はステップ2と大部分が同じ構造で差分が不明確 |

### SEO/AEO品質（16/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| title適切性 | 4 | 4 | 「GAS × ChatGPT API連携｜問い合わせ自動回答」27文字。primary_kw「GAS ChatGPT API 連携」を正確に含有。パイプ区切りで副題も効果的 |
| description質 | 4 | **3** | 157文字で120-160範囲内だがほぼ上限。「コピペで動くコード付きで約40分で構築できます」の行動喚起は良好。ただし「スプレッドシート連携・Slack通知との組み合わせまで」はSlack通知が本文では応用例で軽くしか触れておらず期待値とのギャップあり |
| schema.type適切性 | 4 | 4 | 「HowTo」でhowto記事に合致。estimatedCost・totalTimeも設定済み |
| FAQ質 | 4 | 4 | 4個。無料枠・Claude APIとの違い・APIキー管理・回答品質向上の4テーマが検索意図に合致。回答に具体的なモデル名・操作手順を含む |
| secondary_kw自然配置 | 4 | **1** | keyword-map.csvのsecondary_kw「GAS OpenAI API」はL50-51で言及あり。**「GAS 問い合わせ 自動回答」は本文中で「問い合わせ」「回答ドラフト」「自動生成」と分散配置されているが、AEOの観点で「GASで問い合わせの自動回答を実現する方法」のような結合的な文がない** |

### 内部リンク・導線（14/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| Layer遷移導線 | 5 | 5 | L33でLayer 1ピラー（gas-basics）への導線あり。L34でai-api/openai-api-introへの導線あり。execution→entry導線が冒頭に適切配置 |
| 内部リンク数 | 5 | **3** | ユニーク内部リンク6本（gas-basics, openai-api-intro, gas-claude-api, gas-slack-notification, gas-mail-automation, prompt-engineering-business）で3本以上の基準は満たす。ただし姉妹記事gas-claude-apiにはある**api-key-management**と**gas-form-automation**へのリンクがない。特にAPIキー管理記事は本記事の内容（APIキー設定セクション）と直結 |
| relatedArticles関連性 | 5 | 5 | 同カテゴリ2本（gas/gas-basics, gas/gas-claude-api）+ 別カテゴリ1本（ai-api/openai-api-intro）で適切 |
| リンクテキストの自然さ | 5 | **1** | L263「GAS × Claude API」のリンクテキストがスラッグ的で記事タイトルと不一致（正式: 「GAS × Claude API連携｜AIで入力データを自動分類」）。L265「GASメール自動化」も同様に略称。L267「業務プロンプト設計入門」は記事タイトル「プロンプト設計 業務自動化」（keyword-map primary_kw）と表記揺れ |

### 可読性・文体（16/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| 敬体統一 | 5 | 5 | 全文「です・ます調」で完全統一 |
| 一文の長さ | 5 | 5 | 80文字超過の文がなく適切 |
| 段落構造 | 5 | 5 | 短い段落で区切られ、コードブロック前後に解説・ポイント説明を適切に配置 |
| 専門用語の説明 | 5 | **1** | **UrlFetchApp**（L51初出、未定義）、**temperature**（L103/L129、未定義）、**max_tokens**（L101、未定義）、**systemプロンプト**（L98、未定義）、**API制限**（L170コメント内、未定義）、**トリガー**（L249、未定義）が初出時に説明なし。ターゲット読者が「中小企業の経営者・事務担当者 + エンジニア初学者」であることを考慮すると、これらの専門用語は初出時に括弧書きでの補足が必要 |

### 鮮度・正確性（14/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| API/ツールバージョン最新性 | 5 | **3** | GPT-4o miniを使用しているのは適切。ただしOpenAIが2025年後半にResponses APIを推奨し始めている（openai-api-intro記事ではResponses APIとChat Completions APIの両方を解説済み）のに、本記事ではChat Completions APIのみでResponses APIへの言及がない。注記として「Chat Completions APIを使用。Responses APIについてはOpenAI API入門記事を参照」程度の一文が必要 |
| 料金情報の時点明記 | 5 | 4 | L68「2026年2月時点」、L259「2026年2月時点の概算」で時点表記あり。OpenAI公式料金ページ(L259)へのリンクも付与。L46の「無料クレジット5ドル付与」にはL68で時点表記がカバーされているが距離がある |
| コードの動作保証 | 5 | 4 | 3つのコードブロックがすべて完全で実行可能。`var`宣言を使用（ES5。GAS V8ランタイムでは`const`/`let`推奨だが動作はする）。致命的な問題はないが、V8ランタイム対応の注記があるとベター |
| CLAUDE.md準拠 | 5 | **3** | **「まとめ」セクションの欠落**はhowto記事テンプレートの構造ルール違反。H2-5「応用・カスタマイズ例」に定義文がないのもCLAUDE.md「〇〇とは、△△です。の定義文をセクション冒頭に含める」ルール違反。その他の構造ルール（H2数5以内、表1つ以上、FAQ3-5個、relatedArticles構成）は準拠 |

## セクション別判定

| セクション | 行番号 | 判定 | 理由 |
|-----------|--------|------|------|
| frontmatter | L1-31 | **IMPROVE** | description157文字は許容範囲だが、Slack通知に関する記述を削除し余裕を持たせる。secondary_kw「GAS 問い合わせ 自動回答」をdescriptionに反映するとAEO改善 |
| 冒頭導線+前提表 | L33-47 | **KEEP** | Layer 1リンク2本、結論ファースト、前提表の構成が模範的 |
| H2-1: この記事で作るもの | L49-57 | **IMPROVE** | 定義文あり・機能表あり。UrlFetchAppの用語説明を追加。secondary_kw「GAS 問い合わせ 自動回答」を自然に組み込む一文を追加 |
| H2-2: 準備・APIキーの設定 | L59-76 | **IMPROVE** | 定義文あり。APIキー管理記事（api-key-management）へのリンクを追加（gas-claude-apiと同様）。無料クレジットの時点表記はL68でカバー済みだが、L46とL68の距離を注記で補完 |
| H2-3: 実装手順 | L78-240 | **IMPROVE** | コード品質は高い。temperature・max_tokens・systemプロンプト・API制限の用語説明を追加。ステップ3はステップ2との差分（FAQ連携の仕組み）をより明確にする導入文を追加。Chat Completions APIを使用している旨の注記を追加 |
| H2-4: 動作確認・トラブルシューティング | L242-259 | **KEEP** | エラー表4項目・コスト目安表3項目が実用的。料金時点表記と公式URLリンクも完備 |
| H2-5: 応用・カスタマイズ例 | L262-267 | **REWRITE** | 定義文なし。リンクテキストが略称で不自然。**「まとめ」セクションが完全に欠落**。このセクションを「応用・カスタマイズ例」+「まとめ：次のステップ」の2つに分割し再構成する |

## リファインメントブリーフ（改善指示）

### 優先度1: 「まとめ」セクションの追加【必須】

**対象:** 記事末尾（L267の後）
**問題:** howto記事テンプレートの「まとめ」「次のステップ」セクションが完全に欠落。読者の次アクションが不明確。
**改善指示:**
- H2「まとめ：次のステップ」を追加する
- 以下の要素を含むこと:
  - 記事で構築した内容の3行要約
  - 次に読むべき記事への導線（gas-claude-api, prompt-engineering-business, gas-form-automation）
  - 「まず基本のcallChatGptApi関数を動かし、次にFAQ連携で回答精度を上げてみてください」のような具体的な行動指針

### 優先度2: 専門用語の初出時定義追加【必須】

**対象:** 本文全体の以下の用語
**問題:** ターゲット読者（中小企業経営者・事務担当者・エンジニア初学者）に対して専門用語が未定義。
**改善指示:**
- **UrlFetchApp**（L51初出）: 「UrlFetchApp（GASからWebサービスにHTTPリクエストを送る関数）」
- **temperature**（L103/L129初出）: 「temperature（AIの回答のランダム性を制御するパラメータ。0に近いほど安定した回答）」
- **max_tokens**（L101初出）: 「max_tokens（AIが生成する回答の最大文字数を制御するパラメータ）」
- **systemプロンプト**（L98初出）: 「systemプロンプト（AIの役割や回答ルールを指定する指示文）」
- **トリガー**（L249初出）: 「トリガー（GASのスクリプトを自動実行するタイマー設定。詳しくは[GAS入門ガイド](/articles/gas/gas-basics)参照）」
- コードブロック内のコメントでの補足も可

### 優先度3: H2-5「応用・カスタマイズ例」の再構成【必須】

**対象:** L262-267
**問題:** 定義文なし。リンクテキストが略称。まとめセクションと混在。
**改善指示:**
- 冒頭に定義文を追加: 「応用・カスタマイズ例とは、基本の回答ドラフト生成をベースに、他のGASスクリプトやAPIと組み合わせて業務フローを拡張するパターンです。」
- リンクテキストを正式な記事タイトルに修正:
  - 「GAS × Claude API」 → 「GAS × Claude API連携」（記事タイトル準拠）
  - 「GASメール自動化」 → 「GAS メール自動化」（記事名準拠）
- api-key-management記事とgas-form-automation記事へのリンクを追加
- 「まとめ」を別のH2セクションとして分離（優先度1と連動）

### 優先度4: secondary_kwの自然配置強化

**対象:** H2-1「この記事で作るもの」周辺
**問題:** secondary_kw「GAS 問い合わせ 自動回答」が分散的にしか配置されておらず、AEO観点で引用されにくい。
**改善指示:**
- H2-1の定義文（L50）の直後または機能表の前に、以下のような一文を追加:
  - 「GASで問い合わせの自動回答を実現することで、カスタマーサポートの初動対応を大幅に効率化できます。」
- descriptionの「スプレッドシート連携・Slack通知との組み合わせまで」を「GASで問い合わせ自動回答の仕組みを構築する手順を解説」に変更し、secondary_kwをdescriptionに反映

### 優先度5: Chat Completions API使用の注記追加

**対象:** H2-3「実装手順」冒頭、またはステップ1のコードブロック直前
**問題:** OpenAIがResponses APIを推奨し始めている中、Chat Completions APIのみの解説で将来的な陳腐化リスクがある。
**改善指示:**
- ステップ1のコードブロック前後に以下の注記を追加:
  - 「※本記事ではChat Completions API（`/v1/chat/completions`）を使用しています。2026年2月時点でOpenAIはResponses APIも提供しています。APIの選び方については[OpenAI API入門](/articles/ai-api/openai-api-intro)をご覧ください。」

### 優先度6: ステップ3のコード差分明確化

**対象:** L187-235（ステップ3: 業務知識を組み込んだ高精度な回答）
**問題:** ステップ2のgenerateReplyDrafts関数とステップ3のgenerateSmartReply関数の構造が大部分重複しており、差分がわかりにくい。
**改善指示:**
- ステップ3の冒頭に「ステップ2との違い」を明確にする導入文を追加:
  - 「ステップ2では固定のsystemプロンプトで回答を生成しましたが、ステップ3ではFAQシートの内容を動的にプロンプトに組み込むことで、自社の業務知識に基づいた高精度な回答を実現します。」
- コード内のコメントで、ステップ2との差分箇所（FAQデータ読み込み部分）をハイライト:
  - `// ★ステップ2との違い: FAQデータをsystemPromptに動的に組み込み`

## 保持すべき良い点

- 冒頭のLayer 1リンク（gas-basics, openai-api-intro）の配置が模範的
- 前提表（L41-47）の必要情報が網羅的で、読者が事前準備を判断できる
- callChatGptApi関数のコード品質が高い（JSDoc、エラーハンドリング、muteHttpExceptions）
- APIキーのスクリプトプロパティ保管を強調し、セキュリティ意識を啓発
- GPT-4o miniの選定理由（コスト最適化）が明記されている
- FAQ連携（ステップ3）のアイデアが実務的で差別化ポイント
- トラブルシューティング表が4パターンで実用的
- コスト目安表がモデル別・処理内容別で具体的
- gas-claude-apiとの相互リンク・使い分け提案が横断的
- 料金情報の時点表記と公式URLリンクが適切
- 敬体の完全統一
- H2数が5で上限ちょうど
