# リファインメントブリーフ: discord-slash-commands

## 基本情報
- 対象ファイル: src/content/articles/discord-bot/discord-slash-commands.md
- 監査日: 2026-02-12
- 総合スコア: 78/100
- 判定: **REFINE**

## スコアサマリ

| カテゴリ | スコア | 主な減点理由 |
|---------|--------|-------------|
| コンテンツ品質 | 17/20 | 「まとめ」含め H2 が6つ（ルール上限5）、冒頭 H3「この記事の前提」が H2 に属さない孤立構造 |
| SEO/AEO品質 | 16/20 | description が約110文字で120文字下限未達、schema.estimatedCost が "0" で "0円" 形式と不一致 |
| 内部リンク・導線 | 14/20 | relatedArticles が同カテゴリ3本（別カテゴリ0本、ルール違反）、ピラー記事（discord-bot-overview）への冒頭導線なし |
| 可読性・文体 | 16/20 | 一部の文が80文字超過、「インタラクション」「Deferred Response」等の専門用語が初出時未定義 |
| 鮮度・正確性 | 15/20 | Discord API v10 は2026年2月時点で最新だが記事中にバージョン時点表記なし、GAS無料枠の公式URLリンクなし |

## 詳細採点

### コンテンツ品質（17/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| 結論ファースト | 4 | 4 | L35-36で「GASでDiscordスラッシュコマンドに応答するBotを約60分で構築」と冒頭3行で要約。まとめ表（前提表）も冒頭に配置 |
| 定義文 | 4 | 4 | H2冒頭に定義文あり。L50「Discordスラッシュコマンドとは〜」、L78「環境構築とは〜」、L116「実装手順とは〜」、L281「動作確認とは〜」、L302「応用・カスタマイズとは〜」 |
| 表の活用 | 4 | 4 | 7つの表を効果的に使用（前提表、Webhook比較、準備項目、スクリプトプロパティ、エラー対策、コマンドシナリオ、GAS制限事項） |
| コード実行可能性 | 4 | 4 | 3つのコードブロック全てがコピペで動く完全な状態。エラーハンドリング付き。APIキーはスクリプトプロパティ経由で安全 |
| 情報の具体性 | 4 | **1** | H2が6つ（「まとめ」含む）でルール上限5を超過。冒頭L39の「### この記事の前提」がどのH2にも属さない孤立H3で構造違反 |

### SEO/AEO品質（16/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| title適切性 | 4 | 4 | 「DiscordスラッシュコマンドxGAS実装ガイド」22文字。primary_kw「Discord スラッシュコマンド」含有 |
| description質 | 4 | **2** | 約110文字で120文字下限を下回る。KW含有・内容は良好だが文字数ルール未達 |
| schema.type適切性 | 4 | **3** | HowToでhowto記事に合致。ただし estimatedCost が "0" であり、seo-aeo.md テンプレートの "0円" 形式と不統一 |
| FAQ質 | 4 | 4 | 5個。Webhook違い・登録制限・3秒制限・費用・ファイル送信と多角的。回答も具体的 |
| 副KW自然な配置 | 4 | 3 | 「Discord Bot コマンド」→L72, description。「Discord インタラクション」→L50。自然に配置されているが、本文中での出現頻度がやや少ない |

### 内部リンク・導線（14/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| Layer遷移導線 | 5 | **3** | L32-33でLayer 1記事（gas-basics）へのリンクあり。ただしこれはGASクラスターのピラーであり、**自クラスターのピラー（discord-bot-overview）への冒頭導線がない** |
| 内部リンク数 | 5 | 5 | ユニーク内部リンク4本（gas-basics, discord-bot-gas, discord-spreadsheet-db, gas-slack-notification）。3本以上の要件充足 |
| relatedArticles関連性 | 5 | **1** | 3本全て同カテゴリ（discord-bot-overview, discord-bot-gas, discord-spreadsheet-db）。**別カテゴリからの1本が欠落**（CLAUDE.md「同カテゴリ2本 + 別カテゴリ1本」に違反） |
| リンクテキストの自然さ | 5 | 5 | 「スプレッドシートDBでDiscord Bot」「Discord Bot×GAS連携」等、文脈に溶け込んだ自然なリンクテキスト |

### 可読性・文体（16/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| 敬体統一 | 5 | 5 | 全文「です・ます調」で完全統一 |
| 一文の長さ | 5 | **3** | L50（約83文字「Discordスラッシュコマンドとは〜Discordインタラクション機能です。」）、L19 FAQ回答1（約130文字）等が80文字超過。FAQ回答は許容範囲だがL50は本文 |
| 段落構造 | 5 | 5 | 短い段落・リスト・表・コードブロックの使い分けが適切 |
| 専門用語の説明 | 5 | **3** | スクリプトプロパティ（L112）、Discord API（L121）、doPost（L169）は初出時に定義あり。**Deferred Response（L322）、Embed形式（L312）、type 5（L322）が初出時未定義** |

### 鮮度・正確性（15/20）

| 項目 | 配点 | スコア | 根拠 |
|------|------|--------|------|
| API/ツールバージョン最新性 | 5 | 4 | Discord API v10（L135のURL）は2026年2月時点で最新。ただし「v10を使用」と明示的にバージョンに言及していない |
| 料金情報の時点明記 | 5 | **3** | L45「費用: 0円（GAS・Discord無料、2026年2月時点）」は適切。L326まとめにも「2026年2月時点」あり。**ただしGAS無料枠の上限表（L317-322）に公式URLリンクなし** |
| コードの動作保証 | 5 | 5 | 全コードブロックが完全な状態。PropertiesService使用でAPIキー安全管理。try-catch付きエラーハンドリング |
| CLAUDE.md準拠 | 5 | **3** | H2数超過（6 > 5）、relatedArticles構成ルール違反、description文字数不足、専門用語一部未定義。コード品質・禁止事項は遵守 |

## セクション別判定

| セクション | 判定 | 理由 |
|-----------|------|------|
| frontmatter | **IMPROVE** | description が120文字未達（約110文字）。relatedArticles が同カテゴリ3本で別カテゴリ0本。estimatedCost が "0"（"0円" が望ましい） |
| 導入部（L32-47） | **IMPROVE** | gas-basics へのリンクは適切だが、discord-bot-overview（自クラスターピラー）への導線がない。孤立H3「この記事の前提」を構造的に修正すべき |
| H2-1: この記事で作るもの（L48-74） | **KEEP** | Webhook比較表が秀逸。定義文・処理フロー図・完成物リストの3点セットで読者の全体像把握を支援 |
| H2-2: 準備・環境構築（L76-112） | **KEEP** | 4ステップのDeveloper Portal設定が具体的。スクリプトプロパティの説明付きでセキュリティ意識も良好 |
| H2-3: 実装手順（L114-277） | **KEEP** | 3つのコードブロックが全て完全で実行可能。各コードの「ポイント」説明が丁寧。ステップ4のデプロイ手順も過不足なし |
| H2-4: 動作確認・トラブルシューティング（L279-298） | **KEEP** | 6行のエラー対策表が実用的。症状→原因→解決策の3列構成で素早く問題解決できる |
| H2-5: 応用・カスタマイズ例（L300-322） | **IMPROVE** | コマンドシナリオ表は良好。GAS制限事項表の「Deferred Response（type 5）」が初出時未定義。公式ドキュメントへのリンクなし |
| まとめ（L324-330） | **IMPROVE** | 3本の内部リンクで次ステップが明確。ただしH2構造統合で「応用」と「まとめ」を1セクションにまとめることを検討 |

## リファインメント指示

### 修正1: relatedArticles に別カテゴリ記事を追加【必須・優先度高】

**現状:**
```yaml
relatedArticles: ["discord-bot/discord-bot-overview", "discord-bot/discord-bot-gas", "discord-bot/discord-spreadsheet-db"]
```

**修正後:**
```yaml
relatedArticles: ["discord-bot/discord-bot-overview", "discord-bot/discord-bot-gas", "gas/gas-basics"]
```

**理由:** CLAUDE.md「同カテゴリ2本 + 別カテゴリ1本」ルール。discord-spreadsheet-db は本文中のリンクで十分導線が確保されている。gas-basics は冒頭でリンクしており、GAS前提知識としての関連性が高い。

---

### 修正2: description を120文字以上に拡張【必須・優先度高】

**現状（約110文字）:**
```
GASでDiscordスラッシュコマンドを実装する手順を解説。コマンド登録・インタラクション処理・スプレッドシート連携まで、コピペで動く完全コードとトラブルシューティング表付き。約60分で無料のDiscord Botコマンド機能を構築できます。
```

**修正案（約135文字）:**
```
GASでDiscordスラッシュコマンドを実装する手順を解説。コマンド登録からインタラクション処理・スプレッドシート売上照会まで、コピペで動く完全コード付き。エラー対策表とカスタマイズ例も掲載。約60分・無料でDiscord Botコマンド機能を構築できます。
```

**理由:** config.ts では max(160) のバリデーションのみだが、CLAUDE.md・seo-aeo.md で「120-160文字」が推奨範囲。検索結果のスニペットで途切れない適切な長さにする。

---

### 修正3: H2 構造を5つ以内に統合【必須・優先度中】

**現状（H2が6つ）:**
1. この記事で作るもの
2. 準備・環境構築
3. 実装手順
4. 動作確認・トラブルシューティング
5. 応用・カスタマイズ例
6. まとめ

**修正案（H2を5つに）:**
- 案A: 「応用・カスタマイズ例」と「まとめ」を統合 → 「まとめ・応用例」
- 案B: 「動作確認・トラブルシューティング」を「実装手順」のH3に格下げ（ステップ5として組み込む）

**推奨:** 案B。実装手順の最終ステップとしてトラブルシューティングを含めるのが自然な流れ。「動作確認」は「ステップ5 — 動作確認とトラブルシューティング」として組み込む。

**修正後のH2構造:**
1. この記事で作るもの
2. 準備・環境構築
3. 実装手順（ステップ1-5、ステップ5が動作確認・トラブルシューティング）
4. 応用・カスタマイズ例
5. まとめ

---

### 修正4: 冒頭にdiscord-bot-overviewへの導線を追加【必須・優先度中】

**現状（L32-33）:**
```markdown
> この記事は[GASでできること完全ガイド](/articles/gas/gas-basics)の実装編です。
> 「GASとは何か」から知りたい方は、先にそちらをご覧ください。
```

**修正案:**
```markdown
> この記事は[Discord Bot業務活用ガイド](/articles/discord-bot/discord-bot-overview)のスラッシュコマンド実装編です。
> GASの基礎知識は[GASでできること完全ガイド](/articles/gas/gas-basics)をご覧ください。
```

**理由:** Layer 2記事は自クラスターのピラー（Layer 1）への冒頭導線が必須。現状はGASクラスターのピラーのみリンクしており、discord-botクラスターのピラーへの導線がない。

---

### 修正5: 孤立H3「この記事の前提」をH2-1のH3に移動【必須・優先度中】

**現状:** L39の `### この記事の前提` がどのH2にも属さず、導入部に孤立している。

**修正案:** H2「この記事で作るもの」の直下に移動するか、導入部のブロック引用の後に見出しなしの表として配置する。

**推奨:** 導入部の表として見出し（###）を削除し、冒頭要約テキストの直後に配置。

---

### 修正6: 専門用語の初出時定義を追加【必須・優先度中】

以下の用語に初出時の説明を付ける:

| 用語 | 現在の初出箇所 | 追加すべき定義 |
|------|-------------|--------------|
| Deferred Response | L322（GAS制限事項表内） | Deferred Response（遅延応答：先に受信確認を返してから処理結果を後送する方式） |
| type 5 | L322（同上） | type 5（Deferred Channel Message With Source：遅延応答のレスポンスタイプ） |
| Embed形式 | L312（応用シナリオ表内） | Embed形式（タイトル・色・フィールドを持つDiscordのリッチメッセージ形式） |

---

### 修正7: estimatedCost の形式統一【推奨・優先度低】

**現状:**
```yaml
estimatedCost: "0"
```

**修正案:**
```yaml
estimatedCost: "0円"
```

**理由:** seo-aeo.md のテンプレートでは `estimatedCost: "0円"` が使用されている。JSON-LD出力時の一貫性のため統一する。

---

### 修正8: GAS制限事項表に公式ドキュメントリンクを追加【推奨・優先度低】

**対象:** L315-322のGAS制限事項表

**修正案:** 表の直後に以下を追記:
```markdown
※GASの利用制限の詳細は[Google Apps Scriptの割り当てと制限](https://developers.google.com/apps-script/guides/services/quotas)をご確認ください（2026年2月時点）。
```

**理由:** CLAUDE.md「料金情報は公式URLを必ずリンク」のルール。制限値は料金ではないが、無料枠の制限に関わる情報として公式ソースを示すのが望ましい。

---

### 修正9: L50の長文を分割【推奨・優先度低】

**現状（約83文字）:**
```
Discordスラッシュコマンドとは、ユーザーがDiscord上で「/」を入力してBotに指示を出し、Botが応答する双方向のDiscordインタラクション機能です。
```

**修正案:**
```
Discordスラッシュコマンドとは、ユーザーがDiscord上で「/」を入力してBotに指示を出す機能です。Botが応答を返す双方向のDiscordインタラクションとして動作します。
```

---

## 保持すべき良い点

- 冒頭3行の結論ファーストが明確で、読者が記事の価値を即座に判断できる
- 3つのコードブロックが全て完全な実行可能状態。try-catch付きエラーハンドリングも模範的
- Webhook vs スラッシュコマンドの比較表がFAQ1と連動し、読者の疑問に先回りして回答
- スクリプトプロパティを使ったAPIキー管理で、CLAUDE.md「APIキーをハードコードしない」を完全遵守
- トラブルシューティング表（6パターン）が実用的で、初学者の自己解決を支援
- 各コードブロック直後の「このコードのポイント」リストが学習効果を高めている
- 「2026年2月時点」の時点表記がL45（前提表）とL326（まとめ）の2箇所にある
- 敬体（です・ます調）の完全統一
- 7つの表の活用が情報の視認性を大幅に向上させている
