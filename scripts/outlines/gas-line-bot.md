# 記事ブリーフ: gas-line-bot（リライト）

## 基本情報

| 項目 | 内容 |
|------|------|
| slug | gas-line-bot |
| primary_kw | GAS LINE Bot 作り方 |
| secondary_kw | GAS LINE 通知, LINE Bot 自動化 |
| Layer | execution（Layer 2） |
| 記事タイプ | howto |
| クラスター | gas（ピラー: gas-basics） |
| 想定文字数 | 4,000〜5,000文字 |
| ターゲット読者 | エンジニア初学者・中小企業の事務担当者で、LINE Botによる業務自動化に関心がある人 |
| difficulty | intermediate |
| timeToRead | 20 |
| totalTime | PT60M |

## 現状記事の課題

| 課題 | 詳細 |
|------|------|
| 文字数不足 | 約700文字。目標3,000〜5,000文字に対して大幅に不足 |
| Layer間導線なし | 冒頭にピラー記事（gas-basics）へのリンクがない |
| 前提条件テーブルなし | howtoテンプレートの必須要素が欠落 |
| 完成イメージなし | 何が作れるか読者がイメージできない |
| 手順が断片的 | LINE Developers登録手順、デプロイ手順が省略されている |
| エラーハンドリングなし | コードにtry-catchがなく、実運用に耐えない |
| トラブルシューティングなし | 「動かない」ときの対処法がゼロ |
| 応用例なし | オウム返しで終了。業務活用の展望がない |
| 表が0個 | 品質ルール「表を1つ以上含む」に違反 |
| セキュリティ考慮なし | トークンをハードコードする例になっている |

## 競合分析サマリ

### 上位5記事

| # | 記事 | 深さ | 鮮度 | 独自性 | 弱点 |
|---|------|------|------|--------|------|
| 1 | SIOS Tech Lab | コード付き+実務Tips | 2024/06更新 | GAS/LINE制限事項の指摘 | 業務ユースケースなし |
| 2 | 神戸大学・西田研 | コード付き+教育的解説 | 更新日不明 | API公式ドキュメントの読み方指導 | 業務観点ゼロ |
| 3 | くらぶろぐ | 手順+コード付き | 2025/11更新 | ファイル分割構成 | Tips/注意点が少ない |
| 4 | AutoWorker | コード付き（AI連携） | 2022/03（古い） | Talk API連携 | Talk APIが陳腐化、ChatGPT未対応 |
| 5 | Zenn | 手順+コード付き | 2024/12 | プッシュ配信特化 | Webhook受信を未カバー |

### 必須トピック（3記事以上でカバー → 必ず含める）
- LINE Developersアカウント登録・チャネル作成
- チャネルアクセストークンの発行
- GASプロジェクト作成・doPost関数
- ウェブアプリとしてのデプロイ
- Webhook URL設定
- オウム返し（エコー）Bot動作確認

### 差別化チャンス（1-2記事のみカバー）
- GAS/LINEの制限事項まとめ（SIOS記事のみ）
- スクリプトプロパティによるトークン安全管理（2記事のみ）
- ファイル分割によるコード整理（1記事のみ）
- プッシュメッセージ送信（1記事のみ）

### 独自トピック候補（どの記事もカバーなし）
- エラーハンドリング・デバッグ手法（Logger/console.log が使えない問題への対処）
- スプレッドシート連携の実務活用（問い合わせログ記録など）
- ChatGPT API連携による高度な自動応答
- 中小企業向け業務Botユースケース（問い合わせBot、勤怠Bot、予約管理Bot）
- 本番運用チェックリスト
- デプロイ更新時のバージョン管理

## 差別化ポイント

| パターン | 採用 | 根拠 |
|---------|------|------|
| 実装コード差別化 | **採用** | 競合はエラーハンドリングなしの断片コード。完全動作コード+トークン安全管理+ログ出力まで含めることで差別化 |
| 最新版差別化 | **採用** | 競合の多くが2022-2024年の情報。2026年2月時点の最新UI・API仕様に対応 |
| 実務経験差別化 | **採用** | 競合は全て「オウム返し」で終了。中小企業の業務自動化シナリオ（スプレッドシート連携FAQ Bot等）を示す |
| 網羅性差別化 | **採用** | トラブルシューティング表・制限事項表を含む記事はほぼゼロ |

## 見出し構成案

---

### 冒頭（導線 + 結論ファースト + 前提テーブル）

> この記事は[GASでできること完全ガイド](/articles/gas/gas-basics)の実装編です。
> 「GASとは何か」から知りたい方は、先にそちらをご覧ください。

この記事では、GASとLINE Messaging APIを使って**無料でLINE Botを構築**する手順を解説します。
コードをコピペするだけで動くように、全コードを掲載しています。

| 項目 | 内容 |
|------|------|
| 必要なアカウント | Google, LINE Developers |
| 必要な知識 | [GAS入門記事](/articles/gas/gas-basics)を読了済み |
| 所要時間 | 約60分 |
| 費用 | 0円（GAS・LINE Messaging API無料枠） |
| 完成物 | メッセージに自動応答するLINE Bot + スプレッドシートへのログ記録 |

想定文字数: 200文字

---

### H2-1: この記事で作るもの（完成イメージ）

**書くべき内容:**
- 完成Botの動作フロー図（テキスト図解）: ユーザーがLINEでメッセージ送信 → Webhook → GAS → 応答
- 完成時にできること3点を箇条書き:
  1. テキストメッセージへの自動応答
  2. 受信メッセージのスプレッドシートへの自動記録
  3. 業務活用への拡張ポイント

**含めるべき要素:**
- 処理フローの図解（テキストベース）
- 「無料で運用できる」ことの明記（LINE Messaging API無料枠の範囲）

想定文字数: 400文字

---

### H2-2: 準備・環境構築

**書くべき内容:**
- LINE Developersアカウント登録手順（2026年2月時点の最新UI）
- Messaging APIチャネルの作成手順
- チャネルアクセストークンの発行方法
- GASプロジェクトの新規作成

**含めるべき要素:**

| 準備項目 | 取得方法 | 備考 |
|---------|---------|------|
| LINE Developersアカウント | https://developers.line.biz/ で登録 | LINEアカウントが必要 |
| Messaging APIチャネル | LINE Developers コンソールで作成 | 「チャネルアクセストークン」を控える |
| Googleアカウント | https://accounts.google.com/ | GAS実行に必要 |
| GASプロジェクト | Google Drive → 新規 → Google Apps Script | スクリプトプロパティにトークンを保存 |

- **セキュリティ注意**: チャネルアクセストークンはスクリプトプロパティに保存（コードにハードコードしない）
- スクリプトプロパティ設定手順を明記

想定文字数: 800文字

---

### H2-3: 実装手順

**書くべき内容:**

#### H3-1: ステップ1 — Webhook受信処理（doPost関数）
- doPost関数の役割説明
- イベントオブジェクトの構造解説
- **コード全文**: try-catch付き、ログ出力付きのdoPost
- コードのポイント解説（3点程度）

#### H3-2: ステップ2 — 応答メッセージ送信（replyMessage関数）
- LINE Messaging API のreplyエンドポイント解説
- **コード全文**: スクリプトプロパティからトークン取得、エラーハンドリング付き
- HTTPレスポンスコードの確認方法

#### H3-3: ステップ3 — スプレッドシートへのログ記録
- なぜログが重要か（業務活用の第一歩）
- **コード全文**: 受信メッセージをスプレッドシートに記録する関数
- スプレッドシートのシート構成（日時・ユーザーID・メッセージ内容）

#### H3-4: ステップ4 — デプロイとWebhook設定
- GASのウェブアプリデプロイ手順（「新しいデプロイ」から）
- アクセス権限の設定（「全員」に設定する理由）
- LINE DevelopersコンソールでのWebhook URL設定
- 応答設定の変更（あいさつメッセージOFF、応答メッセージOFF）
- **Webhook検証ボタン**で接続確認

**含めるべき要素:**
- 全コードはコピペで動作する完全版（省略禁止）
- スクリプトプロパティでのトークン管理（`PropertiesService.getScriptProperties()`）
- 各ステップにコードのポイント解説
- コードコメントは日本語で

想定文字数: 1,800文字

---

### H2-4: 動作確認・トラブルシューティング

**書くべき内容:**
- 動作確認手順（LINEアプリからBotにメッセージ送信 → 応答確認 → スプレッドシートログ確認）
- よくあるエラーと解決策の表

**含めるべき要素:**

| エラー/症状 | 原因 | 解決策 |
|------------|------|--------|
| Botが無反応 | デプロイしていない / バージョン未更新 | 「新しいデプロイ」で再デプロイ。コード変更時は**必ず新バージョン**を作成 |
| 「Webhookの利用」がOFFになっている | LINE Developers設定ミス | Messaging API設定 → Webhookの利用をONに変更 |
| 「応答メッセージ」が二重に返る | LINE公式の自動応答が有効 | LINE Official Account Manager → 応答設定 → 応答メッセージをOFF |
| 403エラー | チャネルアクセストークンが無効/未設定 | スクリプトプロパティの`LINE_ACCESS_TOKEN`を確認・再発行 |
| GAS実行エラー（タイムアウト） | 処理が6分を超過 | UrlFetchApp呼び出し回数を最適化。重い処理は別トリガーに分離 |
| スプレッドシートに記録されない | シートIDの設定ミス | スクリプトプロパティの`SHEET_ID`とスプレッドシートURLのIDを照合 |

- **デバッグ方法**: GASではconsole.logの出力がWebhook経由で見えないため、スプレッドシートへのログ書き出しを推奨

想定文字数: 800文字

---

### H2-5: 応用・カスタマイズ例

**書くべき内容:**
- 中小企業向け業務活用シナリオ3選（各2-3行で概要）
  1. **FAQ自動応答Bot**: キーワードマッチでスプレッドシートのFAQデータから回答を返す
  2. **問い合わせ記録Bot**: 顧客からの問い合わせをスプレッドシートに自動蓄積 → 週次レポート
  3. **日報・勤怠連絡Bot**: 定型フォーマットで受け取りスプレッドシートに記録

**含めるべき要素:**
- 各シナリオの実現難易度（★〜★★★）
- 関連記事への内部リンク:
  - 「GASとスプレッドシートの連携について詳しくは[GAS×スプレッドシート自動化](/articles/gas/gas-spreadsheet-automation)をご覧ください」
  - 「Slack通知との組み合わせは[GAS×Slack通知](/articles/gas/gas-slack-notification)で解説しています」
- GAS/LINEの制限事項まとめ表

| 制限事項 | 上限 | 対策 |
|---------|------|------|
| GAS実行時間 | 6分/回 | 重い処理はトリガーで分離 |
| UrlFetch回数 | 20,000回/日（アカウント合計） | 複数Bot運用時は注意 |
| LINE無料メッセージ | 月200通（プッシュ） | Reply（応答）は無制限。プッシュ配信は計画的に |

想定文字数: 700文字

---

### まとめ + CTA

**書くべき内容:**
- 記事の要約（3行以内）
- 次のステップへの誘導

**含めるべき要素:**
- 「GASの基礎から学びたい方は[GAS入門ガイド](/articles/gas/gas-basics)をご覧ください」
- 「他のメッセージツールとの連携に興味がある方は[GAS×Slack通知](/articles/gas/gas-slack-notification)や[Discord Bot×GAS連携](/articles/discord-bot/discord-bot-gas)もおすすめです」

想定文字数: 300文字

---

## FAQ案（5問）

| # | 質問 | 回答の方向性 | ソース |
|---|------|------------|--------|
| 1 | GASでLINE Botを作るのに費用はかかりますか？ | GAS無料 + LINE Messaging API無料枠（応答メッセージ無制限、プッシュ月200通）。有料プランの料金は公式URLリンクし時点明記 | Googleサジェスト |
| 2 | GASで作ったLINE Botが動かない・返信が来ないときは？ | デプロイ忘れ、バージョン未更新、応答設定のON/OFF、トークン設定ミスの4点を確認 | PAA + teratail頻出 |
| 3 | LINE Botの応答速度はどのくらいですか？ | 通常1〜3秒。コールドスタート時はやや遅延するが実用上問題なし | 競合FAQ |
| 4 | GASのLINE BotでChatGPTと連携できますか？ | 可能。OpenAI APIのURLFetchAppによる呼び出しで実現。詳細は別記事で解説予定 | Googleサジェスト（需要急増中） |
| 5 | GASのLINE Botでセキュリティは大丈夫ですか？ | スクリプトプロパティでトークン管理、WebアプリURLの秘匿、定期的なトークンローテーションを推奨 | 競合の空白領域 |

## 内部リンク候補

| リンク先 | 種別 | 配置場所 | リンクテキスト例 |
|---------|------|---------|----------------|
| gas/gas-basics | 同カテゴリ（ピラー） **必須** | 冒頭の導線 + まとめ | 「GASでできること完全ガイド」 |
| gas/gas-spreadsheet-automation | 同カテゴリ | H2-5 応用例 | 「GAS×スプレッドシート自動化の詳細はこちら」 |
| gas/gas-slack-notification | 同カテゴリ | H2-5 応用例 + まとめ | 「Slack通知との組み合わせはこちら」 |
| discord-bot/discord-bot-gas | 別カテゴリ | まとめCTA | 「Discord Botとの比較・連携はこちら」 |

## ライターへの指示

1. **Layer 2テンプレート厳守**: 冒頭にピラー記事（gas-basics）へのリンクを必ず配置
2. **コードは完全版**: 省略禁止。コピペで動作する状態にする。APIキー/トークンはスクリプトプロパティから取得するコードにする（ハードコード禁止）
3. **結論ファースト**: 冒頭3行で「GAS + LINE Messaging APIで無料Bot構築」「コピペで動く全コード掲載」「約60分で完成」を伝える
4. **表を最低3つ含める**: 前提条件テーブル、トラブルシューティング表、制限事項表
5. **セキュリティ**: `PropertiesService.getScriptProperties()` によるトークン管理を必ず採用。LINE_ACCESS_TOKENを直接コードに書かない
6. **2026年2月時点の情報**: LINE Developers管理画面、GASエディタの最新UIに基づいて記述。料金情報は公式URLをリンクし時点を明記
7. **差別化の要**: スプレッドシート連携ログ記録（H2-3 ステップ3）と業務ユースケース（H2-5）が競合との最大の差別化ポイント。ここに厚みを持たせる
8. **文体**: 敬体（です・ます調）統一。専門用語（Webhook、デプロイ、チャネルアクセストークン等）は初出時に必ず説明
9. **frontmatter更新**: updatedAtを執筆日に変更。descriptionを120-160文字で再作成。faqを5問に拡充
