# 記事ブリーフ: gas-spreadsheet-automation（リライト）

## 基本情報

| 項目 | 内容 |
|------|------|
| slug | gas-spreadsheet-automation |
| primary_kw | GAS スプレッドシート 自動化 |
| secondary_kw | GAS 日報 自動化, GAS 集計 |
| Layer | execution（Layer 2） |
| 記事タイプ | howto |
| クラスター | gas（ピラー: gas-basics） |
| 想定文字数 | 4,000〜5,000文字 |
| ターゲット読者 | 中小企業の事務担当者・経営者で、スプレッドシートの繰り返し作業を自動化したい人 |
| difficulty | beginner |
| timeToRead | 15 |
| totalTime | PT45M |

## 現状記事の課題

| 課題 | 詳細 |
|------|------|
| 文字数不足 | 約700文字。目標3,000〜5,000文字に対して大幅に不足 |
| Layer間導線なし | 冒頭にピラー記事（gas-basics）へのリンクがない |
| 前提条件テーブルなし | howtoテンプレートの必須要素が欠落 |
| 完成イメージなし | 何ができるようになるか読者がイメージできない |
| 定義文なし | 各H2冒頭に「〇〇とは、△△です。」がない |
| エラーハンドリングなし | コードにtry-catchがなく、実運用に耐えない |
| トラブルシューティングなし | 「動かない」ときの対処法がゼロ |
| 応用例なし | 集計・メール送信で終了。業務活用の展望がない |
| 表が0個 | 品質ルール「表を1つ以上含む」に違反 |
| 内部リンクなし | 本文中に関連記事へのリンクが1本もない |
| FAQ回答が薄い | 各1文のみ。2-4文の基準を満たさない |

## 競合分析サマリ

### 上位5記事

| # | 記事 | 深さ | 鮮度 | 独自性 | 弱点 |
|---|------|------|------|--------|------|
| 1 | G-gen | 手順+コード付き | 2025/05更新 | 新卒エンジニア執筆・汎用チュートリアル | エラーハンドリングなし、複数シート対応なし |
| 2 | blastengine | 手順+コード+一部Tips | 2025/10更新 | 自社製品誘導が主目的 | エラー処理が浅い、テスト/本番分離なし |
| 3 | inakaonline | 概要+基本コード | 2025/04 | 標準的な内容、事例なし | エラー対応なし、大量データ対応が抽象的 |
| 4 | XIMIX（NTT） | 概要+事例紹介のみ | 2025/04 | 営業コンテンツ、一次情報なし | 実装コード完全欠落、費用対効果データなし |
| 5 | @IT | 手順+Tips（Copilot活用） | 2024/08 | AI活用に一定の独自性 | エラーハンドリング欠落、本番運用面なし |

### 必須トピック（3記事以上でカバー → 必ず含める）
- GASの基本概念・スプレッドシート操作の基礎（getValue/setValue）
- トリガー機能（時間主導型・編集イベント型）
- メール送信連携（GmailApp）
- 初心者向けコード例（実行可能なサンプル）
- 無料枠の制限（実行時間6分、メール100通/日）

### 差別化チャンス（1-2記事のみカバー）
- エラーハンドリング（try-catch）の実装例（ほぼゼロ記事）
- セキュリティ対策・権限設定（2記事のみ表面的）
- 大規模データ対応・6分制限の回避策（1記事のみ）

### 独自トピック候補（どの記事もカバーなし）
- 中小企業向け業務シナリオ（日報自動化、複数シート串刺し集計、請求書生成）
- よくあるエラーと解決策の一覧表
- 実装後の運用ノウハウ（エラー通知、ログ管理）
- トリガー実行失敗時のチェックリスト

## 差別化ポイント

| パターン | 採用 | 根拠 |
|---------|------|------|
| 実装コード差別化 | **採用** | 競合はエラーハンドリングなしの断片コード。完全動作コード+try-catch+ログ出力まで含めることで差別化 |
| 実務経験差別化 | **採用** | 競合は全て汎用チュートリアル。中小企業の日報自動化・集計業務に特化したシナリオを提示 |
| 網羅性差別化 | **採用** | トラブルシューティング表・制限事項表を含む記事はほぼゼロ |
| 構造化差別化 | **採用** | 競合は文章中心。前提条件テーブル、トラブルシューティング表、制限事項表で構造化 |

## 見出し構成案

---

### 冒頭（導線 + 結論ファースト + 前提テーブル）

> この記事は[GASでできること完全ガイド](/articles/gas/gas-basics)の実装編です。
> 「GASとは何か」から知りたい方は、先にそちらをご覧ください。

この記事では、GASでスプレッドシートの**データ集計・日報生成・メール送信**を自動化する手順を解説します。
コードをコピペするだけで動くように、全コードを掲載しています。

| 項目 | 内容 |
|------|------|
| 必要なアカウント | Google（Gmail） |
| 必要な知識 | [GAS入門記事](/articles/gas/gas-basics)を読了済み |
| 所要時間 | 約45分 |
| 費用 | 0円（GAS無料枠内） |
| 完成物 | データ自動集計 + 日次レポートメール自動送信 |

想定文字数: 200文字

---

### H2-1: この記事で作るもの（完成イメージ）

**書くべき内容:**
- 完成する自動化の全体像（テキスト図解）: トリガー発火 → データ集計 → レポート生成 → メール送信
- 完成時にできること3点を箇条書き:
  1. 複数シートのデータを自動集計してサマリーシートに反映
  2. 日次レポートを自動生成してメールで送信
  3. トリガーによる完全自動化（毎朝9時に実行など）

**含めるべき要素:**
- 処理フローの図解（テキストベース）
- 「無料で運用できる」ことの明記
- 対象業務の例示（売上集計、在庫確認、日報送信など）

想定文字数: 400文字

---

### H2-2: 準備・環境構築

**書くべき内容:**
- GASプロジェクトの作成（スプレッドシートから「拡張機能」→「Apps Script」）
- サンプルデータの準備（売上データシートの構成）

**含めるべき要素:**

| シート名 | 構成 | 役割 |
|---------|------|------|
| 売上データ | 日付・商品名・金額・担当者 | 元データ |
| サマリー | 合計金額・最終更新日時・担当者別集計 | 集計結果 |

- サンプルスプレッドシートの列構成を明示
- 「拡張機能」→「Apps Script」でエディタを開く手順

想定文字数: 500文字

---

### H2-3: 実装手順

**書くべき内容:**

#### H3-1: ステップ1 — データ自動集計（GAS集計の基本）
- getValues()でデータを一括取得する理由（セル単位取得との速度差）
- **コード全文**: try-catch付き、複数シート対応の集計スクリプト
- 担当者別・日別などのグループ集計パターン
- コードのポイント解説（3点程度）

#### H3-2: ステップ2 — 日次レポート自動生成・メール送信
- GmailApp.sendEmail()の使い方
- **コード全文**: 集計結果をフォーマットしてメール送信
- 送信先・件名・本文のカスタマイズ方法
- メール送信制限（無料アカウント100通/日）への言及

#### H3-3: ステップ3 — トリガーによる定期実行
- トリガーとは何か（定義）
- **コード全文**: 毎朝9時に集計→メール送信を実行するトリガー設定
- GUIからのトリガー設定方法も併記（コードが苦手な人向け）
- トリガーの制限事項（無料アカウント: 1日の合計実行時間90分）

**含めるべき要素:**
- 全コードはコピペで動作する完全版（省略禁止）
- 各ステップにコードのポイント解説
- コードコメントは日本語で
- GAS集計の副KWを自然に含める

想定文字数: 1,800文字

---

### H2-4: 動作確認・トラブルシューティング

**書くべき内容:**
- 動作確認手順（手動実行 → ログ確認 → メール受信確認 → トリガー確認）
- よくあるエラーと解決策の表

**含めるべき要素:**

| エラー・症状 | 原因 | 解決策 |
|------------|------|--------|
| 「関数が見つかりませんでした」 | 関数名のタイポ or 保存していない | コード保存（Ctrl+S）後、関数名を確認 |
| 「このアプリはブロックされます」 | OAuth認証が未承認 | 「詳細」→「安全でないページに移動」で承認 |
| メールが届かない | GmailApp.sendEmail()の送信先ミス | 送信先アドレスをログ出力して確認 |
| 集計結果が0になる | getValues()の範囲指定ミス or データ型の不一致 | Logger.log(data)でデータ内容を確認 |
| トリガーが実行されない | 認証切れ or スクリプトエラー | トリガー一覧で「最後の実行」を確認。再認証 |
| 「実行時間の上限を超えました」 | 処理が6分を超過 | getValues()で一括取得、ループ内のAPI呼び出しを削減 |

- **デバッグ方法**: Logger.log()とスプレッドシートUIの「実行数」タブの使い方

想定文字数: 800文字

---

### H2-5: 応用・カスタマイズ例

**書くべき内容:**
- 中小企業向け業務活用シナリオ3選（各2-3行で概要）
  1. **GAS日報自動化**: カレンダーから予定を取得→スプレッドシートに転記→メールで上司に送信
  2. **月次レポート自動生成**: 月末に売上データを集計→グラフ用データ整形→PDF出力
  3. **在庫アラート通知**: 在庫数が閾値を下回ったらSlack/メールで通知

**含めるべき要素:**
- 各シナリオの実現難易度（★〜★★★）
- 関連記事への内部リンク:
  - 「Slack通知との組み合わせは[GAS×Slack通知](/articles/gas/gas-slack-notification)で解説しています」
  - 「LINE通知で社外向けに展開する方法は[GAS×LINE Bot](/articles/gas/gas-line-bot)をご覧ください」
- GASの制限事項まとめ表

| 制限事項 | 上限（無料アカウント） | 対策 |
|---------|---------------------|------|
| スクリプト実行時間 | 6分/回 | getValues()一括取得、ループ最適化 |
| トリガー合計実行時間 | 90分/日 | 処理を分割、不要トリガーを削除 |
| メール送信数 | 100通/日 | 送信先をまとめる、重要度で絞る |
| UrlFetch回数 | 20,000回/日 | 外部API呼び出しを最小化 |

想定文字数: 700文字

---

### まとめ + CTA

**書くべき内容:**
- 記事の要約（3行以内）
- 次のステップへの誘導

**含めるべき要素:**
- 「GASの基礎から学びたい方は[GAS入門ガイド](/articles/gas/gas-basics)をご覧ください」
- 「スプレッドシートの自動化データをLINEやSlackに通知する方法は[GAS×LINE Bot](/articles/gas/gas-line-bot)や[GAS×Slack通知](/articles/gas/gas-slack-notification)で解説しています」
- 「自動化の費用対効果を試算するには[自動化ROI計算テンプレート](/articles/frameworks/automation-roi-template)をご活用ください」

想定文字数: 300文字

---

## FAQ案（5問）

| # | 質問 | 回答の方向性 | ソース |
|---|------|------------|--------|
| 1 | GASでスプレッドシートの自動化はどのくらい時間短縮できますか？ | 定型的なデータ集計やレポート作成なら月あたり数時間〜十数時間の削減が期待できる。たとえば毎日15分の集計作業を自動化すれば月5時間以上の削減。ROI計算は別記事リンク | Googleサジェスト |
| 2 | GASのトリガー機能とは何ですか？ | 特定の条件（時間、イベント）でスクリプトを自動実行する機能。時間主導型（毎朝9時など）と編集トリガー（セル変更時）がある。無料アカウントでは1日合計90分の実行制限あり | PAA |
| 3 | スプレッドシートの大量データでGASは遅くなりますか？ | 数万行を超えると処理速度が低下する。対策はgetValues()で一括取得、ループ内のAPI呼び出し削減、6分制限に達する場合は処理を分割してトリガーで連携 | 競合FAQ |
| 4 | GASで「このアプリはブロックされます」と表示されたときは？ | Google側のセキュリティ警告。「詳細」→「〇〇（安全ではないページ）に移動」で承認可能。自分が作成したスクリプトなら安全に承認できる。組織管理者がブロックしている場合はWorkspace管理者に相談 | PAA + teratail頻出 |
| 5 | GASのスプレッドシート自動化でセキュリティは大丈夫ですか？ | GASはGoogleのサーバー上で実行されるため、コード自体は安全に管理される。注意すべきはスプレッドシートの共有設定（閲覧・編集権限）と、外部API連携時の認証情報管理。スクリプトプロパティでトークンを保管し、コードにハードコードしない | 競合の空白領域 |

## 内部リンク候補

| リンク先 | 種別 | 配置場所 | リンクテキスト例 |
|---------|------|---------|----------------|
| gas/gas-basics | 同カテゴリ（ピラー） **必須** | 冒頭の導線 + まとめ | 「GASでできること完全ガイド」 |
| gas/gas-slack-notification | 同カテゴリ | H2-5 応用例 + まとめ | 「GAS×Slack通知の詳細はこちら」 |
| gas/gas-line-bot | 同カテゴリ | H2-5 応用例 + まとめ | 「LINE通知で社外展開する方法はこちら」 |
| frameworks/automation-roi-template | 別カテゴリ | まとめCTA | 「自動化の費用対効果を試算するにはこちら」 |

## ライターへの指示

1. **Layer 2テンプレート厳守**: 冒頭にピラー記事（gas-basics）へのリンクを必ず配置
2. **コードは完全版**: 省略禁止。コピペで動作する状態にする。メールアドレスはプレースホルダー（`your-email@example.com`）を使用
3. **結論ファースト**: 冒頭3行で「GASでスプレッドシート集計・日報・メール送信を自動化」「コピペで動く全コード掲載」「約45分で完成」を伝える
4. **表を最低3つ含める**: 前提条件テーブル、トラブルシューティング表、制限事項表
5. **副KWの自然な挿入**: 「GAS 日報 自動化」をH2-5の応用例で使用、「GAS 集計」をH2-3 ステップ1で使用
6. **差別化の要**: トラブルシューティング表（H2-4）と中小企業向け業務シナリオ（H2-5）が競合との最大の差別化ポイント。エラーハンドリング付きコードも全競合が欠落している差別化要素
7. **文体**: 敬体（です・ます調）統一。専門用語（トリガー、getValues、OAuth等）は初出時に必ず説明
8. **frontmatter更新**: updatedAtを執筆日に変更。descriptionを120-160文字で再作成。faqを5問に拡充。tagsに「日報」を追加
9. **relatedArticles**: gas/gas-basics + gas/gas-slack-notification（同カテゴリ2本） + frameworks/automation-roi-template（別カテゴリ1本）
