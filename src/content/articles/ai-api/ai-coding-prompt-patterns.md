---
title: "AIにコードを書かせるプロンプトパターン集"
description: "AIコーディングツールに業務自動化スクリプトを書かせるためのプロンプトパターン集。GAS・Python・Botの3カテゴリ計9パターンを、そのままコピペで使えるテンプレート形式で掲載。プロンプトの構造と使い分けの判断基準も解説。そのままコピペで使えます。"
category: "ai-api"
tags: ["プロンプト", "AIコーディング", "テンプレート", "業務自動化", "AI コード生成"]
publishedAt: 2026-02-12
updatedAt: 2026-02-12
author: "れん"
difficulty: "beginner"
timeToRead: 10
layer: "execution"
articleType: "reference"
schema:
  type: "Article"
faq:
  - question: "どのAIツールで使えますか？"
    answer: "Claude Code、ChatGPT、GitHub Copilot、Cursorなど主要なAIコーディングツールすべてで使えます。プロンプトの基本構造は共通です。ツールごとの違いは「AIコーディングツール比較」記事をご覧ください。"
  - question: "プロンプトをそのまま使っても良いですか？"
    answer: "はい、テンプレートとしてそのままコピペできます。【】で囲まれた部分を自社の業務内容に書き換えてください。シート名、列構成、通知先URLなどの具体値を実際の環境に合わせれば、そのまま動くコードが生成されます。"
  - question: "生成されたコードの品質は大丈夫ですか？"
    answer: "AIが生成したコードは必ず動作確認が必要です。特にAPIキーのハードコード・無限ループ・大量メール送信の有無を確認してください。本記事の「チェックポイント」欄に確認すべき項目を記載しています。"
  - question: "パターンをカスタマイズするコツはありますか？"
    answer: "【制約】セクションに具体的な技術要件を追記すると精度が上がります。例えばエラー処理の方法、使用するライブラリのバージョン、コーディング規約などを明示してください。曖昧な指示ほどAIの出力もブレやすくなります。"
  - question: "GAS以外の言語でも同じパターンは使えますか？"
    answer: "はい、4要素（役割指定・タスク・入出力定義・制約条件）の構造はどの言語でも有効です。【役割指定】を「Pythonの〜」「TypeScriptの〜」に変えるだけで応用できます。"
relatedArticles:
  - "ai-api/claude-code-automation"
  - "ai-api/ai-coding-non-engineer"
  - "frameworks/prompt-engineering-business"
draft: false
---

> この記事は[Claude Codeで業務自動化](/articles/ai-api/claude-code-automation)の補足リファレンスです。
> プロンプト設計の基本原則は[業務プロンプト設計入門](/articles/frameworks/prompt-engineering-business)をご覧ください。

AIコード生成に使えるプロンプトパターンを、業務自動化でよく使う9パターンにまとめました。
AIへのコーディング指示をテンプレート化しており、【】内を自社の業務内容に書き換えるだけで使えます。

## プロンプトの基本構造

プロンプトの基本構造とは、AIに意図通りのコードを生成させるための指示文の定型フォーマットのことです。

AIコーディング指示を構造化すると、出力されるコードの品質が安定します。
すべてのパターンは以下の4要素で構成されています。

| 要素 | 役割 | 記載例 |
|------|------|--------|
| 役割指定 | AIの専門性を定義 | 「GASの業務自動化エキスパートとして」 |
| タスク | やりたいことを具体的に | 「売上データを月別に集計する」 |
| 入出力定義 | データの形式と構造を明示 | 「A列: 日付、B列: 金額 → 月別合計」 |
| 制約条件 | 守るべきルール | 「APIキーはスクリプトプロパティから取得」 |

## GAS系パターン

GAS系パターンとは、GAS（Google Apps Script: Googleスプレッドシートなどを自動操作するスクリプト環境）で業務データの処理・メール送信・API連携を自動化するためのプロンプトテンプレートです。

### パターン1: データ集計

```text
GASの業務自動化エキスパートとして、以下のスクリプトを作成してください。

【タスク】
「【シート名】」シートのデータを【集計単位】で集計し、結果を「【出力シート名】」シートに出力する

【入力データ】
- A列: 【項目1】（【形式】）
- B列: 【項目2】
- C列: 【集計対象の数値項目】
- 1行目はヘッダー

【出力】
- A列: 【集計キー】
- B列: 合計
- C列: 件数

【制約】
- getValues()で一括取得、setValues()で一括書き込み
- 出力シートが存在しない場合は新規作成
- 既存データはクリアしてから書き込み
```

**チェックポイント:** 生成コードでgetRange/getValueがループ内で呼ばれていないか確認してください（パフォーマンス低下の原因）。

### パターン2: メール一斉送信

```text
GASの業務自動化エキスパートとして、以下のスクリプトを作成してください。

【タスク】
「送信リスト」シートの宛先にテンプレートメールを一斉送信する

【送信リストシート】
- A列: メールアドレス
- B列: 【差し込み項目1（例: 会社名）】
- C列: 【差し込み項目2（例: 担当者名）】
- D列: 送信済み（「済」でスキップ）
- 1行目はヘッダー

【テンプレートシート】
- A1: 件名
- A2: 本文（{{【差し込み項目1】}}と{{【差し込み項目2】}}をプレースホルダーとして使用）

【制約】
- 送信済み列が「済」の行はスキップ
- 送信後にD列に「済」、E列に送信日時を記入
- Utilities.sleep(1000)でGmail制限対策
- GmailApp.sendEmailを使用
```

**チェックポイント:** テスト時は送信先を自分のアドレスに変更して動作確認すること。

### パターン3: AI API連携（分類処理）

```text
GASの業務自動化エキスパートとして、以下のスクリプトを作成してください。

【タスク】
スプレッドシートのテキストデータを【AI API名（Claude API / ChatGPT API）】で自動分類する

【入力データ（【シート名】）】
- A列: 分類対象のテキスト
- B列: 分類結果（空欄のものだけ処理）
- 1行目はヘッダー

【分類カテゴリ】
「【カテゴリ1】」「【カテゴリ2】」「【カテゴリ3】」「その他」

【出力】
- B列: 分類結果
- C列: 要約（30文字以内）

【制約】
- APIキーはスクリプトプロパティ「【プロパティ名】」から取得
- コードにAPIキーをハードコードしない
- muteHttpExceptions: true を設定
- Utilities.sleep(1000)でAPI制限対策
- エラー時はB列に「エラー: 」+メッセージを記入
```

詳しい実装は[GAS × Claude API連携](/articles/gas/gas-claude-api)・[GAS × ChatGPT API連携](/articles/gas/gas-chatgpt-api)をご覧ください。

## 通知Bot系パターン

通知Bot系パターンとは、Discord・Slack・Googleフォームと連携して業務通知を自動化するためのプロンプトテンプレートです。

### パターン4: Discord定時通知

```text
GASの業務自動化エキスパートとして、以下のスクリプトを作成してください。

【タスク】
「【シート名】」シートのデータを集計し、Discord Webhook（外部サービスにデータを送る仕組み）で通知する

【通知内容】
- タイトル: 「【通知タイトル】」
- フィールド1: 【項目名】 = 【集計値】
- フィールド2: 【項目名】 = 【集計値】
- Embed形式（Discordのリッチ表示フォーマット）で色つき表示

【制約】
- Webhook URLはスクリプトプロパティ「DISCORD_WEBHOOK_URL」から取得
- 土日は送信しない（getDay()で判定）
- 日付はAsia/Tokyoタイムゾーンで表示
```

**チェックポイント:** Webhook URLが正しいか、テスト用チャンネルで送信確認してください。

[Discord定時通知Botの作り方](/articles/discord-bot/discord-scheduler-bot)で詳細を解説しています。

### パターン5: Slack通知

```text
GASの業務自動化エキスパートとして、以下のスクリプトを作成してください。

【タスク】
「【シート名】」シートで【条件】を満たすデータを検知し、Slack Webhookで通知する

【通知条件】
- 【列】の値が【閾値】を【超えた/下回った】場合

【通知内容】
- テキスト: 【通知メッセージ】
- Block Kit形式（Slackのリッチメッセージ形式）でセクション表示

【制約】
- Webhook URLはスクリプトプロパティ「SLACK_WEBHOOK_URL」から取得
- 通知済みフラグで重複通知を防止
```

**チェックポイント:** 通知済みフラグのリセット漏れに注意してください。テスト時はテスト用チャンネルを使用してください。

[GAS × Slack通知](/articles/gas/gas-slack-notification)で詳細を解説しています。

### パターン6: Googleフォーム連携

```text
GASの業務自動化エキスパートとして、以下のスクリプトを作成してください。

【タスク】
Googleフォームの回答送信時に自動で処理を実行する

【フォーム項目】
- 【項目1】: 【回答形式】
- 【項目2】: 【回答形式】
- 【項目3】: 【回答形式（ラジオボタンの選択肢: 選択肢1 / 選択肢2 / 選択肢3）】

【処理内容】
- 回答者に受付確認メールを送信
- 【条件分岐の項目】の値に応じて通知先を切り替え
- onFormSubmitトリガーで自動実行

【制約】
- e.namedValuesでフォームデータを取得
- 質問名はフォームの質問文と完全一致させる
```

**チェックポイント:** onFormSubmitトリガーの設置を忘れずにおこなってください。テスト時はフォームから実際に回答を送信して確認してください。

[GAS × Googleフォーム連携](/articles/gas/gas-form-automation)で詳細を解説しています。

## Python系パターン

Python系パターンとは、CSVやExcelなどのローカルファイルを対象にAI APIやファイル操作を自動化するためのプロンプトテンプレートです。

### パターン7: AI APIバッチ処理

```text
Pythonの業務自動化エキスパートとして、以下のスクリプトを作成してください。

【タスク】
CSVファイルのテキストデータを【AI API名】で一括処理する

【入力】
- ファイル: 【ファイル名.csv】
- 列: 【処理対象列名】

【処理】
- 各行のテキストを【処理内容（分類/要約/翻訳）】
- 結果を新しい列に追加

【出力】
- 【出力ファイル名.csv】に保存

【制約】
- APIキーは環境変数から取得（os.getenv）
- rate limit対策でtime.sleep(1)を挿入
- エラー時はスキップして続行し、最後にエラー件数を表示
- tqdm（Pythonの進捗バー表示ライブラリ）で進捗表示
```

**チェックポイント:** 大量データの場合はまず10行でテスト実行し、API利用料を確認してから全件処理してください。

### パターン8: ファイル整理・リネーム

```text
Pythonの業務自動化エキスパートとして、以下のスクリプトを作成してください。

【タスク】
指定フォルダ内のファイルを【ルール】に基づいて整理する

【整理ルール】
- 【拡張子】のファイルを「【フォルダ名】」フォルダに移動
- ファイル名を「【命名規則】」にリネーム

【制約】
- 実行前にドライラン（移動先を表示するだけ）モードで確認
- 同名ファイルが存在する場合は連番を付与
- pathlib（Pythonのファイルパス操作ライブラリ）を使用
```

**チェックポイント:** 必ずドライランモードで移動先を確認してから実行してください。

### パターン9: レポート自動生成

```text
Pythonの業務自動化エキスパートとして、以下のスクリプトを作成してください。

【タスク】
【データソース（CSV/Excel/DB）】から【レポート種類】を自動生成する

【入力データ】
- ファイル: 【ファイル名】
- 主要列: 【日付列】, 【数値列】, 【カテゴリ列】

【出力】
- 【出力形式（PDF/Excel/HTML）】で保存
- 【グラフ種類】を含む

【制約】
- pandasでデータ処理
- matplotlib/plotlyでグラフ生成
- 日本語フォント対応
```

**チェックポイント:** 出力PDFの日本語フォントが文字化けしていないか確認してください。

## パターン選択ガイド

| やりたいこと | 推奨パターン | 関連記事 |
|------------|------------|---------|
| データ集計 | パターン1 | [GASスプレッドシート自動化](/articles/gas/gas-spreadsheet-automation) |
| メール送信 | パターン2 | [GASメール自動化](/articles/gas/gas-mail-automation) |
| AI分類 | パターン3 | [GAS × Claude API](/articles/gas/gas-claude-api) |
| Discord通知 | パターン4 | [Discord定時通知Bot](/articles/discord-bot/discord-scheduler-bot) |
| Slack通知 | パターン5 | [GAS × Slack通知](/articles/gas/gas-slack-notification) |
| フォーム処理 | パターン6 | [GAS × フォーム連携](/articles/gas/gas-form-automation) |
| AI一括処理 | パターン7 | 準備中 |
| ファイル整理 | パターン8 | 準備中 |
| レポート生成 | パターン9 | 準備中 |

プロンプト設計の原則は[業務プロンプト設計入門](/articles/frameworks/prompt-engineering-business)、AIコーディングの全体像は[Claude Codeで業務自動化](/articles/ai-api/claude-code-automation)をご覧ください。
AI APIの業務活用全体像は[AI APIを業務に組み込む方法](/articles/ai-api/ai-api-overview)をご覧ください。
